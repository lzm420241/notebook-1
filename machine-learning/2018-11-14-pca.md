# Principle Component Analysis (PCA)



一个样本常常会由多个属性，也就是有多个维度，但是有的维度之间可能具有相关性，还有的维度则完全是噪声。主成分分析（PCA）是为了寻找样本的多个属性中的主要属性，即主成分，这些主要的成分能够很大程度上刻画样本的特征。

如下图所示，每个样本包含两个属性，其特征体现在两个垂直方向上，但是其主要特征则体现在箭头较长的那个方向上。

<div align="center"><img src="../images/18-11-30/pca.png" width="500px" /></div>

所以如果将样本均投影在这个方向上，就得到了降维的目的，由两维降到了一维。PCA 就是用来寻找这个主要方向的方法。

PCA 将原 M 维的数据降维至 D 维，就相当于对原来 M 维的数据做了一次坐标变换。

其基本思想有两种：

1. 让样本在变换后的各个维度上应该分的足够开，即有较大的方差。
2. 让样本在变换后的重建误差足够小

### 最大化方差

<div align="center"><img src="../images/18-11-30/pca1.png" width="500px" /></div>

坐标变换，实际上就是对样本 x 的各个维度做一个线性组合，如下图所示 x 是变换前的样本，z 是变换后的坐标。x 维度为 M，z 维度为 D，<img src="https://latex.codecogs.com/gif.latex?z_1%24%E5%B0%B1%E6%98%AFx%E5%9C%A8%24w%5E1%24%E4%B8%8A%E7%9A%84%E6%8A%95%E5%BD%B1%E3%80%82%E5%85%B6%E4%B8%AD%24w%5E1" class="tex" alt="z_1$就是x在$w^1$上的投影。其中$w^1" /> 是单位向量。

<div align="center"><img src="../images/18-11-30/pca2.png" width="500px" /></div>

要保证在变换后，各个维度上有较大的方差，同时满足约束条件 W 为单位正交矩阵：

<div align="center"><img src="../images/18-11-30/pca3.png" width="500px" /></div>

首先对求方差的式子进行化简：

<div align="center"><img src="../images/18-11-30/pca4.png" width="500px" /></div>

在约束条件下求极值，使用拉格朗日乘子法：

<div align="center"><img src="../images/18-11-30/pca5.png" width="500px" /></div>

可以看出，要最大化 <img src="https://latex.codecogs.com/gif.latex?(w%5E1)%5ETSw%5E1%3D%5Calpha(w%5E1)%5ETw%5E1%24%EF%BC%8C%E5%B0%B1%E6%98%AF%E8%AE%A9%E5%AE%83%E7%AD%89%E4%BA%8ES%E7%9A%84%E6%9C%80%E5%A4%A7%E7%9A%84%E7%89%B9%E5%BE%81%E5%80%BC%EF%BC%8C%E8%BF%99%E6%A0%B7%E4%BB%A5%E6%9D%A5%24w%5E1" class="tex" alt="(w^1)^TSw^1=\alpha(w^1)^Tw^1$，就是让它等于S的最大的特征值，这样以来$w^1" /> 就是 S 最大特征值对应的特征向量。

<div align="center"><img src="../images/18-11-30/pca6.png" width="500px" /></div>

相应地 <img src="https://latex.codecogs.com/gif.latex?w%5E2" class="tex" alt="w^2" /> 就是 S 第二大的特征值对应的特征向量。

因此，主成分就是 x 的协方差的最大的 N 个特征值对应的特征向量。这里的 N 取决于实际项目需要。

### 最小化重建误差

要利用主成分重建原样本，一种方法是对主成分进行线性组合，就相当于拿主成分拼凑出原样本。另外一种方法是在所有样本的均值的基础上，加上主成分的线性组合，相当于在均值的基础上，进行修修补补得出原样本。

如果主成分具有很好的代表性，那么就能让重建误差足够小，因此可以定义损失函数：

<div align="center"><img src="../images/18-11-30/pca7.png" width="500px" /></div>

这里 <img src="https://latex.codecogs.com/gif.latex?u%5Ek" class="tex" alt="u^k" /> 为主成分，为了让误差足够小，即让下面的等式两边足够接近。写成矩阵形式：

<div align="center"><img src="../images/18-11-30/pca8.png" width="500px" /></div>

因为 X 的 SVD 分解，可以保证分解后的矩阵相乘得到的结果和原矩阵相近，因此 U 的各列就可以作为主成分，后面两个矩阵 ∑ 和 V 的乘积就相当于系数矩阵 C。通过调整 SVD 分解时中间矩阵的维度，就可以得到不同数量的主成分。
